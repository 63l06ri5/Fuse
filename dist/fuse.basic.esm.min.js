/**
 * Fuse.js v5.2.0-alpha.2 - Lightweight fuzzy-search (http://fusejs.io)
 *
 * Copyright (c) 2020 Kiro Risk (http://kiro.me)
 * All Rights Reserved. Apache Software License 2.0
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
const t=t=>Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t),e=t=>"string"==typeof t,s=t=>"number"==typeof t,n=t=>null!=t;function i(i,o){let r=[],c=!1;const l=(i,o)=>{if(o){const h=o.indexOf(".");let a=o,u=null;-1!==h&&(a=o.slice(0,h),u=o.slice(h+1));const d=i[a];if(n(d))if(u||!e(d)&&!s(d))if(t(d)){c=!0;for(let t=0,e=d.length;t<e;t+=1)l(d[t],u)}else u&&l(d,u);else r.push((t=>null==t?"":(t=>{if("string"==typeof t)return t;let e=t+"";return"0"==e&&1/t==-1/0?"-0":e})(t))(d))}else r.push(i)};return l(i,o),c?r:r[0]}var o={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score-e.score,includeMatches:!1,findAllMatches:!1,minMatchCharLength:1,location:0,threshold:.6,distance:100,...{useExtendedSearch:!1,getFn:i}};function r(t,{errors:e=0,currentLocation:s=0,expectedLocation:n=0,distance:i=o.distance}={}){const r=e/t.length,c=Math.abs(n-s);return i?r+c/i:c?1:r}function c(t,e,s,{location:n=o.location,distance:i=o.distance,threshold:c=o.threshold,findAllMatches:l=o.findAllMatches,minMatchCharLength:h=o.minMatchCharLength,includeMatches:a=o.includeMatches}={}){const u=e.length,d=t.length,f=Math.max(0,Math.min(n,d));let g=c,p=t.indexOf(e,f);console.log("bestLocation",p);const y=[];for(let t=0;t<d;t+=1)y[t]=0;if(-1!==p){let s=r(e,{errors:0,currentLocation:p,expectedLocation:f,distance:i});if(g=Math.min(s,g),console.log({score:s,currentThreshold:g}),p=t.lastIndexOf(e,f+u),console.log({bestLocation:p,expectedLocation:f}),-1!==p){let t=r(e,{errors:0,currentLocation:p,expectedLocation:f,distance:i});g=Math.min(t,g)}}p=-1;let m=[],M=1,x=u+d;const _=1<<(u<=31?u-1:30);for(let n=0;n<u;n+=1){let o=0,c=x;for(;o<c;){r(e,{errors:n,currentLocation:f+c,expectedLocation:f,distance:i})<=g?o=c:x=c,c=Math.floor((x-o)/2+o)}x=c;let h=Math.max(1,f-c+1),a=l?d:Math.min(f+c,d)+u,k=Array(a+2);k[a+1]=(1<<n)-1;for(let o=a;o>=h;o-=1){console.log("start",h);let c=o-1,l=s[t.charAt(c)];if(console.log("charMatch",l,t.charAt(c)),l&&(y[c]=1),k[o]=(k[o+1]<<1|1)&l,0!==n&&(k[o]|=(m[o+1]|m[o])<<1|1|m[o+1]),k[o]&_&&(M=r(e,{errors:n,currentLocation:c,expectedLocation:f,distance:i}),M<=g)){if(g=M,p=c,p<=f)break;h=Math.max(1,2*f-p)}}if(r(e,{errors:n+1,currentLocation:f,expectedLocation:f,distance:i})>g)break;m=k}let k={isMatch:p>=0,score:M||.001};return a&&(k.matchedIndices=function(t=[],e=o.minMatchCharLength){let s=[],n=-1,i=-1,r=0;for(let o=t.length;r<o;r+=1){let o=t[r];o&&-1===n?n=r:o||-1===n||(i=r-1,i-n+1>=e&&s.push([n,i]),n=-1)}return t[r-1]&&r-n>=e&&s.push([n,r-1]),s}(y,h)),k}class l{constructor(t,e=({location:location=o.location,threshold:threshold=o.threshold,distance:distance=o.distance,includeMatches:includeMatches=o.includeMatches,findAllMatches:findAllMatches=o.findAllMatches,minMatchCharLength:minMatchCharLength=o.minMatchCharLength,isCaseSensitive:isCaseSensitive=o.isCaseSensitive}={})){if(this.options=e,t.length>32)throw new Error("Pattern length exceeds max of 32.");this.pattern=this.options.isCaseSensitive?t:t.toLowerCase(),this.patternAlphabet=function(t){let e={},s=t.length;for(let n=0;n<s;n+=1)e[t.charAt(n)]=0;for(let n=0;n<s;n+=1)e[t.charAt(n)]|=1<<s-n-1;return e}(this.pattern)}searchIn(t){let e=t.$;return this.searchInString(e)}searchInString(t){const{isCaseSensitive:e,includeMatches:s}=this.options;if(e||(t=t.toLowerCase()),this.pattern===t){let e={isMatch:!0,score:0};return s&&(e.matchedIndices=[[0,t.length-1]]),e}const{location:n,distance:i,threshold:o,findAllMatches:r,minMatchCharLength:l}=this.options;return c(t,this.pattern,this.patternAlphabet,{location:n,distance:i,threshold:o,findAllMatches:r,minMatchCharLength:l,includeMatches:s})}}function h(t,{n:e=3,pad:s=!0,sort:n=!1}){let i=[];if(null==t)return i;t=t.toLowerCase(),s&&(t=` ${t} `);let o=t.length-e+1;if(o<1)return i;for(;o--;)i[o]=t.substr(o,e);return n&&i.sort((t,e)=>t==e?0:t<e?-1:1),i}function a(s,o,{getFn:r=i,ngrams:c=!1}={}){let l=[];if(e(o[0]))for(let t=0,e=o.length;t<e;t+=1){const e=o[t];if(n(e)){let s={$:e,idx:t,t:e.split(/ /g).length};c&&(s.ng=h(e,{sort:!0})),l.push(s)}}else{const i=s.length;for(let a=0,u=o.length;a<u;a+=1){let u=o[a],d={idx:a,$:{}};for(let o=0;o<i;o+=1){let i=s[o],l=r(u,i);if(n(l))if(t(l)){let s=[];const o=[{arrayIndex:-1,value:l}];for(;o.length;){const{arrayIndex:i,value:r}=o.pop();if(n(r))if(e(r)){let t={$:r,idx:i,t:r.split(/ /g).length};c&&(t.ng=h(r,{sort:!0})),s.push(t)}else if(t(r))for(let t=0,e=r.length;t<e;t+=1)o.push({arrayIndex:t,value:r[t]})}d.$[i]=s}else{let t={$:l,t:l.split(/ /g).length};c&&(t.ng=h(l,{sort:!0})),d.$[i]=t}}l.push(d)}}return l}class u{constructor(t){if(this._keys={},this._keyNames=[],this._length=t.length,t.length&&e(t[0]))for(let e=0;e<this._length;e+=1){const s=t[e];this._keys[s]={weight:1},this._keyNames.push(s)}else{let e=0;for(let s=0;s<this._length;s+=1){const n=t[s];if(!Object.prototype.hasOwnProperty.call(n,"name"))throw new Error('Missing "name" property in key object');const i=n.name;if(this._keyNames.push(i),!Object.prototype.hasOwnProperty.call(n,"weight"))throw new Error('Missing "weight" property in key object');const o=n.weight;if(o<=0||o>=1)throw new Error('"weight" property in key must be in the range of (0, 1)');this._keys[i]={weight:o},e+=o}for(let t=0;t<this._length;t+=1){const s=this._keyNames[t],n=this._keys[s].weight;this._keys[s].weight=n/e}}}get(t,e){return this._keys[t]?this._keys[t][e]:-1}keys(){return this._keyNames}count(){return this._length}toJSON(){return JSON.stringify(this._keys)}}function d(t,e){const s=t.matches;if(e.matches=[],n(s))for(let t=0,i=s.length;t<i;t+=1){let i=s[t];if(!n(i.indices)||0===i.indices.length)continue;let o={indices:i.indices,value:i.value};i.key&&(o.key=i.key),i.idx>-1&&(o.refIndex=i.idx),e.matches.push(o)}}function f(t,e){e.score=t.score}const g=[],p=require("util");class y{constructor(t,e={},s=null){this.options={...o,...e},this._processKeys(this.options.keys),this.setCollection(t,s)}setCollection(t,s=null){this.list=t,this.listIsStringArray=e(t[0]),s?this.setIndex(s):this.setIndex(this._createIndex())}setIndex(t){this._indexedList=t}_processKeys(t){this._keyStore=new u(t)}_createIndex(){return a(this._keyStore.keys(),this.list,{getFn:this.options.getFn})}search(t,e={limit:!1}){const{shouldSort:n}=this.options;let i=null;for(let e=0,s=g.length;e<s;e+=1){let s=g[e];if(s.condition(t,this.options)){i=new s(t,this.options);break}}i||(i=new l(t,this.options));let o=this._searchUsing(i);return this._computeScore(o),n&&this._sort(o),e.limit&&s(e.limit)&&(o=o.slice(0,e.limit)),this._format(o)}_searchUsing(e){const s=this._indexedList,i=[],{includeMatches:o}=this.options;if(this.listIsStringArray)for(let t=0,r=s.length;t<r;t+=1){let r=s[t],{$:c,idx:l,t:h}=r;if(!n(c))continue;let a=e.searchIn(r);const{isMatch:u,score:d}=a;if(!u)continue;let f={score:d,value:c,t:h};o&&(f.indices=a.matchedIndices),i.push({item:c,idx:l,matches:[f]})}else{const r=this._keyStore.keys(),c=this._keyStore.count();for(let l=0,h=s.length;l<h;l+=1){let{$:h,idx:a}=s[l];if(!n(h))continue;let u=[];for(let s=0;s<c;s+=1){let i=r[s],c=h[i];if(n(c))if(t(c))for(let t=0,s=c.length;t<s;t+=1){let s=c[t];const{$:r,idx:l,t:h}=s;if(!n(r))continue;let a=e.searchIn(s);const{isMatch:d,score:f}=a;if(!d)continue;let g={score:f,key:i,value:r,idx:l,t:h};o&&(g.indices=a.matchedIndices),u.push(g)}else{const{$:t,t:s}=c;let n=e.searchIn(c);const{isMatch:r,score:l}=n;if(!r)continue;let h={score:l,key:i,value:t,t:s};o&&(h.indices=n.matchedIndices),u.push(h)}}u.length&&i.push({idx:a,item:h,matches:u})}}return i}_computeScore(t){const e=1+Math.log(this._indexedList.length/(t.length+1));console.log("----------------");const s=this._keyStore.count()||1;for(let n=0,i=t.length;n<i;n+=1){const i=t[n],o=i.matches,r=o.length;let c=0;for(let t=0;t<r;t+=1){const e=o[t],{t:s}=e;c+=s}let l=r/c*e;console.log("ITEM---");let h=1;for(let t=0;t<r;t+=1){const e=o[t],{key:n,value:i,t:c}=e,a=1/Math.sqrt(c),u=this._keyStore.get(n,"weight"),d=u>-1?u:1,f=e.score||Number.EPSILON;console.log("-------"),console.log(n,i),console.log({t:c,tfidf:l,norm:a,weight:d,score:f,numMatches:r,keysLen:s});const g=r/s*(1+l*a);h*=Math.pow(f,d*g)}if(i.score=h,i.score>=1)throw console.log("***********************"),console.log(i),console.log("***********************"),new Error("Error with score")}}_sort(t){t.sort(this.options.sortFn),console.log(p.inspect(t,!1,null,!0))}_format(t){const e=[],{includeMatches:s,includeScore:n}=this.options;let i=[];s&&i.push(d),n&&i.push(f);for(let s=0,n=t.length;s<n;s+=1){const n=t[s],{idx:o}=n,r={item:this.list[o],refIndex:o};if(i.length)for(let t=0,e=i.length;t<e;t+=1)i[t](n,r);e.push(r)}return e}}y.version="5.2.0-alpha.2",y.createIndex=a,y.config=o;export default y;